#include "Riostream.h"
#include <TROOT.h>
#include "TMinuit.h"
#include "TMath.h"
#include "TRandom1.h"
#include <ctime>

std::clock_t start = std::clock();
int s = (std::clock() - start) / (double) (CLOCKS_PER_SEC );
int sector = 1;


double calculate_residual(int sector, int i, double *par) {
	// nominal shifts by Raffaella de Vita were shifts of 0.2 cm and rotations of 0.1 degrees
	// may need to update these values in future
	double shift = 0.2;
	double rot = 0.2;

	// values in these lists are in micrometers
	// rotations around x and z axis are negligible when compared to other rotations so we do
	// not use them

	double r1_z_list_1[38] = {138.92446945025017, 138.02738723605626, 111.15702746529041, 
		127.61240943195219, 101.37247155028308, 113.47147164610703, 111.5698366781719, 
		98.88711778166055, 111.98454400965397, 108.00597956494357, 84.64995288597925, 
		105.072061167681, -58.568818879185926, -92.9644393025165, -38.926235316453244, 
		-53.1079871042802, -50.24875046238566, -47.85275880622805, -44.6745089485579, 
		-36.7868029993183, -52.15218510557651, -92.41425406767979, -63.055545328342134, 
		-83.0149845684856, 6.017311593948733, 7.441462091541666, 6.252008982729663, 
		64.82943348824026, -10.657059213142091, 15.266538396040687, 15.076967145298227, 
		66.49192115581073, 11.418955301846836, 47.637520323566235, 50.554593791515046, 
		16.159907918595593, -0.3296254131472643, 0.22267241379310332};
	double r1_z_list_2[38] = {76.22379291296579, 74.82803638872338, 129.10858499741084, 
		83.67543385523845, 99.42957323427368, 192.916278575226, 78.37333090501647, 
		84.78858967836732, 88.43982658354685, 125.61063728191652, 111.68459962614884, 
		68.31360871509014, -41.193568931834875, -34.02986522537503, -28.442545943441644, 
		-38.67688881966416, -47.62808787878117, -19.282749300424143, -74.09113004939866, 
		-104.10950617147182, -103.31476261625426, -94.24678925784781, -82.46230833915445, 
		-97.94925344925412, -12.736601404439853, -3.6696977750407314, -16.661640505867013, 
		25.046307429989724, 5.791488370443076, 12.9984823222606, 14.060291555603783, 
		8.809007836407716, 26.93377824610684, -0.8505395197097414, 30.069624903166698, 
		44.28518184746031, -1.1634027279253403, 0.10799861415867887};
	double r1_z_list_3[38] = {152.97249844818543, 167.34680285853256, 129.05094219094963, 
		143.16754141540264, 113.765917678905, 135.284127920512, 103.0536814096713, 
		138.47084251417186, 127.13211955319639, 127.80226996219221, 105.05798185043454, 
		121.52727164806788, -97.87539577882933, -80.28027877354066, -62.26715109449151, 
		-72.69961828971373, -69.05700035681582, -81.68631590637858, -91.96431354215383, 
		-106.57749192651033, -76.3192173186651, -87.15577868120465, -93.01229797192934, 
		-104.3176776662284, 52.95277823556279, 23.68387540664463, 40.78979069558824, 
		33.24332531949892, 32.237542618153896, 28.63541731577149, 2.7308735380400435, 
		-19.360619379150933, 17.49862200792262, 19.75021436868286, 49.08824189989306, 
		20.38888248979572, 0.22063902825455484, -0.2987593984962406};
	double r1_z_list_4[38] = {119.2791225333292, 130.54992260444703, 140.3812246416246, 
		113.87334208307982, 105.78724017084426, 120.14112920498849, 93.63999644889384, 
		89.73530037137414, 129.8085955219242, 110.62261561063224, 100.98507231266069, 
		98.01530763448648, -62.62754538353994, -48.05229201484178, -85.6424111793009, 
		-63.954930429521255, -47.454433555271066, -43.28730517698705, -70.9826869280854, 
		-60.62969512504117, -79.54761771953747, -90.31171919852443, -55.51999987183592, 
		-84.39157941425805, 11.760985828278876, 44.682335720940074, 28.293613997024664, 
		18.771553430567906, 25.68544731106587, 28.14126043960104, 33.69456937254, 
		38.803162609995894, 12.993969971099347, 28.1341774599575, 21.35489348785609, 
		31.430061259395245, 0.12284646013401958, 0.11537720706260024};
	double r1_z_list_5[38] = {161.20671285466653, 139.6735995361314, 168.75682164557475, 
		163.36185968306427, 148.71778514721666, 152.1783318919131, 169.79213277080845, 
		156.05493579481856, 132.76592772871817, 137.75792954586512, 127.37934519436129, 
		152.12415419003963, -76.74632835101664, -72.3870896062985, -52.78012954878025, 
		-58.74383025583552, -72.11704625756241, -57.57447414208991, -91.93842849413852,
		 -53.15922587578052, -65.40630768771857, -76.82028277443453, -93.55599802247625, 
		 -86.68583815162356, -9.278563067536837, 7.694324614497322, 16.05975613968417, 
		 30.60427894536483, 26.467014469986736, 29.083837109156224, 9.82766981181625, 
		 7.452623737864386, -15.36818843045522, 33.39151746359577, 20.589951074492213, 
		 45.8654220683736, -0.03542797881403022, 0.41528571428571404};
	double r1_z_list_6[38] = {117.46425170239829, 143.13964888783178, 128.1440920416544, 
		108.22588054940883, 150.60709947577027, 180.89288752765015, 78.54696667929915, 
		82.42901758930618, 75.18299555294138, 82.37826577310656, 102.0328701503525, 
		92.66929903118107, -40.663856057699945, -50.88205275097188, -68.10561216575097, 
		-72.18098547888594, -39.48321400061535, -94.73335460872069, -26.754450160881333, 
		-74.06199810465634, -32.00842677371536, -53.12986390718092, -60.76665624068262, 
		-60.54897536542818, 6.900808907945704, 1.0271184730156833, 16.874290009149878, 
		23.26681497581182, 68.46198428211756, 2.3759050445584284, 1.5367562109919533, 
		13.908098191359308, 5.705178962830459, 43.289053206630925, 13.384322214270565, 
		-11.50755101788068, -0.2644750083864473, 0.42943734763529967};

	double r2_z_list_1[38] = {-235.78992479040653, -237.06767625035695, -240.12764211789806, 
		-241.79370065301123, -232.0697134853333, -235.57008320052853, -213.26234028003705, 
		-210.1021494280293, -221.67216345369195, -213.85858495968387, -212.53363442061118, 
		-216.85373420337862, 113.67016833859248, 112.97813016943115, 115.4533988445217, 
		110.27523218871471, 118.02405582764436, 126.76433275352457, 133.1666426626175, 
		129.00365946998295, 135.1695294134871, 127.95453489399051, 135.0694008040548, 
		135.61746374110362, -53.14661320107086, -47.381162475359815, -46.85637268382399, 
		-49.54385422651961, -43.211882744116735, -40.32015434275317, -49.68367617532283, 
		-43.19116916421237, -40.2167877066545, -42.19926176176196, -37.4220789000389, -37.8139858808872, 
		-0.29927086840735895, 0.019270477421737892};
	double r2_z_list_2[38] = {-127.84698902605624, -170.76680113001112, -179.16358420839197, 
		-161.86917240569574, -256.6899978789802, -251.371180814308, -198.9316816816813, 
		-210.02669500703723, -192.48196379624142, -196.17545502330995, -197.34218779607363, 
		-201.49331292733154, 80.358067653901, 74.61346706519964, 75.78886955742576, 70.60590949735399, 
		84.79190594335648, 76.25884111351309, 138.90034223342354, 136.04268627353622, 
		143.541092124437, 137.6657166957964, 134.23516857468826, 148.11406462422974, 
		-36.80240533999893, -36.415404252289534, -27.093765451225778, -25.14023054221809, 
		-23.086864878042206, -20.275984755755573, -51.949117687421165, -51.63727472244335, 
		-43.196762883383485, -40.97634492270271, -40.06828587290917, -40.86542311471379, 
		-1.425789871504155, 0.04976688258795229};
	double r2_z_list_3[38] = {-225.51803864507906, -225.21352142650903, -224.17087172379183, 
		-222.207890671918, -215.29518879859347, -208.28015182873332, -193.52718468946978, 
		-205.5101703681562, -195.50519981370348, -204.52677380797832, -201.1596782487461, 
		-195.18490315109648, 121.6870080909481, 122.2694810345115, 117.33381984417645, 
		121.08505855651947, 124.78417757372927, 122.52631332606109, 134.16775894882892, 
		138.90656411261114, 140.8743212152949, 142.38306377957065, 142.283248553965, 
		137.68915247787527, -45.69450591252604, -48.06308470678698, -42.096519373873974, 
		-38.59966218919635, -37.94321829291195, -32.99639147782767, -46.75061994638122, 
		-50.85668546955776, -41.741730127187964, -41.182085503148926, -34.59488842645547, 
		-35.057714459129954, 0.14249222475637557, -0.5661721384205859};
	double r2_z_list_4[38] = {-222.47992700605687, -231.880827555696, -227.37826690359248, 
		-223.89570362776203, -223.76415568863763, -231.66229233820582, -194.76750497557475, 
		-211.67764381586426, -208.89673059925087, -200.22331173980956, -194.07429908972426, 
		-211.85710221261616, 113.03634570923464, 112.87997894816476, 111.68211274927125, 
		120.89308288724669, 123.10193217794688, 127.14005738235517, 130.50842338346615, 
		132.54530632900548, 126.55921583056409, 128.57421692885157, 134.7785502544324, 
		139.05756607709327, -53.590610906109134, -52.26828758793232, -41.05136972828035, 
		-40.99214739501281, -44.54747550589255, -40.646844935664205, -44.080905453581465, 
		-43.33481405374266, -39.42026948576698, -39.41170901137198, -39.649450282125116, 
		-33.94554589075898, 0.09042193990332051, -0.11925148022709};
	double r2_z_list_5[38] = {-254.90088844025968, -250.31683909126787, -253.4358455850741, 
		-243.47495846702355, -253.0850770874519, -242.37808951772314, -216.7464735624249, 
		-223.94748563229885, -228.571606564015, -233.32804277205844, -220.25521444407184, 
		-227.0657622671744, 120.72550979925418, 111.02647644348855, 114.92638856554213, 
		120.6794055201697, 118.97238536342536, 127.44969476522911, 139.3384819872656, 
		144.93570231923948, 142.49499244321584, 129.13795027122478, 145.91258885457114, 
		145.0350043765273, -47.79003244221717, -46.303009615448374, -36.17046668914949, 
		-39.21749134811272, -42.52706539365407, -33.580153431451876, -52.10613598673309, 
		-46.90150402547735, -42.29454892578154, -39.64974736791689, -39.13245948719924, 
		-39.08040201005039, -0.13174750830564794, 0.14202486414054913};
	double r2_z_list_6[38] = {-269.59529252111963, -262.14396315606047, -270.0759713653897, 
		-269.5042376378335, -259.5024929287117, -258.82775630446736, -238.1418700776746, 
		-229.2556334607944, -235.5750346609329, -239.65733153416198, -236.15471611956636, 
		-241.08752523974363, 133.5959326342548, 131.66245791245794, 136.16185408251988, 
		124.58337789015782, 133.5624273178983, 126.91433596637296, 145.2122926071397, 
		151.36167185126084, 143.68928541185863, 150.01792168021058, 150.3482912981768, 
		154.66118953392808, -56.74865372573579, -57.4499178422742, -53.57540220759316, 
		-51.50309820307682, -43.65600979472183, -41.798867891800924, -52.73205823497985, 
		-41.46243904765289, -48.13722105223316, -44.12670442514882, -44.00318132689931, 
		-38.34237620683487, -0.2573330132052822, 0.11402817446870299};

	double r3_z_list_1[38] = {121.84362713369558, 118.75823069354158, 116.82897128000025, 
		113.50083169644404, 114.77821108009584, 107.09072284967942, 107.69089359473367, 
		109.63402393763658, 103.29569983294834, 99.3731740439091, 110.69030227099768, 
		99.32219095690164, -48.34517096551207, -49.41010442895026, -51.609792942351135, 
		-56.50260845456563, -60.90560497009841, -62.9129791332756, -56.243886938162404, 
		-61.420888071720924, -63.87779430967464, -68.87776848977308, -69.05718923978867, 
		-74.51885923373084, 33.903623232674136, 29.37356425114004, 25.777385369102078, 
		20.875254300765704, 15.857721692357842, 12.120365746239031, 32.41872859594804, 
		27.090279696082263, 21.881568360291936, 19.438341918901727, 16.795221413545846, 
		10.118661822131884, -0.2930799807275353, 0.11556302521008402};
	double r3_z_list_2[38] = {83.1543650648689, 85.82618990300352, 104.0336447730192, 78.8903735179374, 
		113.87182334073555, 123.32586431086725, 102.24192728197318, 101.58685735943595, 
		91.66365769152867, 97.27252569902157, 90.18251384851646, 96.22616811403009, 
		-29.996864252511216, -31.677349657215757, -35.797676812233306, -42.6386341955685, 
		-42.72888182866376, -49.02027858589611, -62.60409662337236, -63.81314028014219, 
		-64.67275587583049, -66.17515412343266, -73.91384564187547, -78.20457280385074, 
		27.3286338168096, 17.21843424447991, 16.052193580272274, 10.309976186943459, 
		4.622202526035949, 1.4752151973879393, 32.87021854668603, 30.86281505168506, 
		27.855528263975714, 16.431619461812716, 16.157257953920578, 13.431365497187812, 
		-1.118371576609918, 0.23561206814504604};
	double r3_z_list_3[38] = {103.86451122900053, 110.21086138127544, 108.77809375022207, 
		111.4184440786346, 105.10519913005601, 104.2726314948809, 100.00200386954066, 
		104.99987644063185, 95.5610167991133, 95.1772301661008, 90.73604844164015, 
		92.65821878787028, -52.160175997104375, -53.57094465293221, -55.59869153330715, 
		-60.82809663798196, -64.57063633537985, -65.6791894485334, -61.044719714680696, 
		-66.02298138253911, -65.23074945365647, -68.75745450238071, -69.92035118254034, 
		-79.37017659018954, 31.1642066857155, 27.811936842246553, 20.272070508517203, 
		20.80881389656747, 13.055445212432545, 12.318176953264299, 33.99846816420222, 
		27.204546217757922, 21.95017182130576, 21.06330557595345, 16.41180857130314, 
		10.25090883714094, 0.49578497320716003, -0.22443098065491038};
	double r3_z_list_4[38] = {110.78388571694518, 113.08703321697124, 112.33401871930096, 
		107.91794155910372, 108.6444868356117, 110.21980581460116, 100.35814147183055, 
		99.57412163017204, 95.92609774094092, 101.48746151287878, 97.94622579700774, 
		94.34297549507676, -55.201951729202676, -50.64426355840288, -56.340358132070605, 
		-58.46900309093934, -60.55686533045497, -65.09691048042538, -60.478860052941855, 
		-60.573939350363275, -61.02933932639587, -68.41080310477315, -68.82715161568342, 
		-73.14781665310574, 31.64546473236527, 25.504950087235443, 27.166293274583623, 
		20.679409500850852, 15.662560874883098, 11.759309655820715, 26.0972274789613, 
		23.42506838941935, 20.855531445645923, 17.899105066948948, 14.624033616782498, 
		8.371835160423785, 0.2944037062506785, 0.17155136091682813};
	double r3_z_list_5[38] = {118.6177784303419, 118.0765707367218, 123.62108527131784, 
		125.40889676083259, 112.53972622831543, 115.79452259237576, 106.3887476602327, 
		108.6984423258188, 102.37679029819355, 106.19116287204918, 95.91937335810064, 
		102.5302357957018, -51.06561929699291, -51.74851350248986, -56.835622927522536, 
		-55.82605960525285, -57.97273735932799, -65.63987725770897, -60.44870692198907, 
		-63.56295657482559, -60.54782845018437, -66.40001935526527, -74.85836480297525, 
		-79.38358604467606, 31.20779698100779, 26.890815387872514, 23.95071882393654, 
		18.035415409395853, 10.215386880884225, 4.715089404134405, 36.15133652432928, 
		25.795285858156628, 20.33141231088095, 19.410330081835387, 12.814207832580792, 
		10.533083234139383, 0.18654924983692092, 0.37142271587769243};
	double r3_z_list_6[38] = {136.54859002162473, 131.49553889612775, 120.24884051569464, 
		133.45720638608302, 126.29256424500551, 119.08541926217661, 116.65393348587975, 
		122.66914402987449, 122.09889747944577, 111.83132360326596, 107.34731205260769, 
		101.63571887857219, -53.98915833907145, -58.94640897286196, -61.373244081531126, 
		-62.72244770527617, -57.61095283317512, -73.3142575708532, -67.14650671998224, 
		-68.85087724017721, -69.27672411290804, -68.56536366616682, -76.45756230098854, 
		-72.39118908818561, 31.41184784166218, 29.141623636182544, 22.82458016038714, 
		15.978247734533156, 9.24400147014989, 9.661982651236663, 32.49892845445739, 
		25.486168705950686, 23.061675917028275, 18.920032181844547, 11.274631930381641, 
		10.018980267403407, 0.06769347712480381, 0.45393884376493066};

	double r1_x_list_1[38] = {-761.382776747734, -748.6378604471215, -769.4365143442171, 
		-771.456380064035, -796.6001160113686, -784.7611190030273, -676.3931627584965, 
		-690.5867645521932, -690.2578900370457, -686.6941459599828, -709.7657009918877, 
		-705.0430433821131, 420.7294710706112, 391.36797310970456, 403.063972314294, 
		377.71334161446117, 373.61253763669197, 396.2469425045713, 463.16590706522175, 
		448.297914432866, 426.6275565973025, 389.02159925126506, 414.7613002222387, 
		422.98973970960094, -125.71811789920343, -134.20917125134838, -150.53800510243624, 
		-139.29856586999614, -172.55775429938322, -182.0637467778423, -102.19160717281969, 
		-86.0134845060553, -121.70455787239372, -127.38951385014249, -128.97149265650336, 
		-158.9551454304373, -0.10886077481840213, 0.2968876239441792};
	double r1_x_list_2[38] = {-177.32478614230604, -236.26928511669485, -203.67090991773944, 
		-177.00059973679276, -340.681613843293, -299.6226682363299, -282.1673951930693, 
		-271.49968519887216, -259.27438215912525, -253.7348367319005, -259.06874828351147, 
		-283.96379161721575, 167.3817413697044, 164.7876525006272, 157.6732603288276, 
		154.1083709586233, 150.10537397900748, 159.07925350302514, 187.55537484489366, 
		160.61425826014602, 160.76941879464437, 148.92156502401735, 154.52197730815396, 
		160.28361120129705, -55.921053536633906, -51.710581190411006, -53.67105318247296, 
		-46.46164068158629, -83.53537258394127, -53.99911836726578, -51.538647887289926, 
		-55.51913119883551, -48.096842804867265, -79.29946289653981, -58.78084075197546, 
		-56.526465560170664, -1.118371576609918, 0.23561206814504604};
	double r1_x_list_3[38] = {366.49946050121775, 381.9450533940412, 360.56917178801655, 
		373.84664209003404, 354.8370404960167, 371.8537434271325, 373.584758787601, 
		389.77850488566446, 391.38804205177223, 410.0361337090187, 388.43817993695984, 
		375.392970732177, -164.90270434217427, -165.34645236451354, -155.30641358779053, 
		-148.91267048064594, -149.10472905098027, -140.06082827496368, -300.4252007697728, 
		-298.9827353154975, -269.13630210634767, -281.5389793650355, -280.93902439461976, 
		-287.6966767370078, 52.99629127886794, 36.60316526489743, 51.89989861594171, 
		44.22899180852568, 51.63432546994517, 51.80254661942007, 66.51361099534512, 
		55.628652062066465, 79.52330384410362, 93.18849098420685, 96.08555087355445, 
		102.79503017537633, 0.49578497320716003, -0.22443098065491038};
	double r1_x_list_4[38] = {839.699889384329, 829.0566359386121, 854.0954661825273, 
		849.9262802176302, 840.7594149448156, 843.7660829255293, 703.3525290387906, 
		706.9067734952441, 731.5499326330707, 753.9129210426747, 753.0344304626466, 
		761.3867136014355, -463.64227127944207, -442.20216177553283, -438.8234059707125, 
		-422.49101309140997, -420.05294957176613, -409.5341254519709, -482.2334663791627, 
		-463.97653825655783, -452.76455891948893, -456.01178573860795, -434.5920359506737, 
		-457.69870316520786, 121.23363706103235, 147.55587604538968, 155.17648488429256, 
		141.4898784395829, 174.14627655178086, 173.24903120413012, 110.98498933183261, 
		122.4648992732259, 118.42540671069459, 135.10290667253201, 151.45583754886823, 
		164.65479578427022, 0.2944037062506785, 0.17155136091682813};
	double r1_x_list_5[38] = {444.152046123882, 437.6840011820127, 463.8123397957792, 
		458.2655089286386, 449.44443535706034, 455.03201677934544, 320.55369883284465, 
		335.88561704781665, 332.00495323839726, 326.00869153650854, 325.75071932762864, 
		350.5329944403899, -287.664553923357, -269.3416128972795, -247.29245532481718, 
		-268.0104690494011, -252.99549573586222, -255.93842588211464, -186.98943091646152, 
		-177.61234002885817, -175.1093308914409, -167.48018080142333, -177.95994181076256, 
		-175.5794400868255, 68.56402574906578, 67.99850279025479, 81.53325822631047, 
		95.56947293550932, 90.55077233064841, 109.64106732031948, 44.516229723241, 
		32.30364961303384, 16.78270410208357, 39.52685152916298, 64.8649100624042, 
		61.34260002545762, 0.18654924983692092, 0.37142271587769243};
	double r1_x_list_6[38] = {-369.7570427825832, -364.54457803001765, -372.30115038511065, 
		-403.8377090547799, -362.3472703001414, -348.6202748380602, -405.0187535956412, 
		-405.7513727722925, -409.69748855781495, -423.31425644413986, -428.4312432011037, 
		-430.05631494119643, 176.05826854265996, 160.2824811316944, 162.9507125499967, 
		153.42134370221032, 159.28923679666661, 132.74741131685408, 300.863109657285, 
		269.979649775819, 285.1629639023002, 263.01901518354674, 267.69187237474773, 
		268.2192130449421, -55.57815002715927, -54.17581020468632, -48.84847850365824, 
		-53.73736261560468, -34.12986155632014, -72.3889517640846, -68.78956071408382, 
		-79.88226684372907, -73.66383513853387, -86.53368389335463, -102.73381240772562, 
		-109.28931057792775, 0.06769347712480381, 0.45393884376493066};

	double r2_x_list_1[38] = {1628.9778721345351, 1625.2105222347852, 1602.4014832812159, 
		1623.0824489304373, 1604.7863884889512, 1551.2809834170139, 1428.3590000922286, 
		1447.4211462294368, 1414.863114538294, 1460.7649143690296, 1436.4208569207622, 
		1409.3969133359715, -748.4012213310083, -744.6925830395764, -739.9460364381555, 
		-751.3869645812897, -767.8716103242589, -799.7737574678217, -849.4087800416914, 
		-841.4874392782785, -837.2032496810446, -851.3473597285813, -866.1207088301392, 
		-895.962875388738, 322.2543081246014, 312.4780024113287, 307.5506448925277, 
		273.05691440258505, 257.53158417821123, 258.2654767375302, 292.801060695975, 
		272.68805594433843, 249.48546405014108, 245.6334262651397, 242.41883379526575, 
		228.5158568645124, -0.02794331673688261, 0.12820623470307851};
	double r2_x_list_2[38] = {744.7470662623665, 774.2829211735077, 836.544820468281, 
		739.167950780155, 693.805341364164, 702.453969807407, 555.5798445504325, 
		582.9507429429433, 572.6240008385579, 554.4804740249741, 535.2283908182803, 
		530.4700192081175, -286.709983072797, -284.5732421211956, -291.95812589205286, 
		-309.66577842152645, -309.73024065695677, -340.37253454262236, -338.1361945820482, 
		-332.66461439887166, -333.79725990674945, -350.26257387364814, -344.1421581360312, 
		-367.4201566531701, 142.11821935663897, 115.20730152804842, 113.90005321741678, 
		103.98448458113612, 83.74122360989172, 64.82213512663226, 126.59853825801358, 
		117.17529962216713, 114.37429800034073, 103.17752742612896, 94.01786468709574,
		98.75386381930056, -0.5918486672398974, -0.02472137220164286};
	double r2_x_list_3[38] = {-622.3750347686102, -612.9849295453516, -597.4527048761238, 
		-603.4546524128848, -587.5932843931346, -598.6637924365978, -646.3523432650529, 
		-672.0194681431813, -647.4705688157128, -655.5516827849549, -648.5186766838015, 
		-643.5781163486531, 271.0483920889958, 269.491550879952, 274.3451956063176, 
		272.9422728855317, 287.0234336158919, 284.2452324432072, 525.9592860314799, 
		523.299102531355, 535.2992844187181, 530.157339492601, 545.4437275078724, 
		543.0075507245795, -111.82598259017857, -103.32113423366775, -100.38257535736491, 
		-84.45790165047947, -85.86071110543747, -79.39736180363514, -187.588700800764, 
		-179.4206625150021, -181.91108680666537, -165.13409303549184, -166.22987351033458, 
		-155.19003871804148, 0.23553706739244726, -0.38600539083557955};
	double r2_x_list_4[38] = {-1270.424897901302, -1284.0240380469306, -1267.033392169849, 
		-1281.3741491239687, -1223.240363810483, -1256.6060591382995, -1213.2575426322696, 
		-1207.8491390473507, -1194.140604670668, -1194.6575616593013, -1168.4511427938496, 
		-1188.6099073399077, 774.5388603622883, 785.7346782942786, 772.725777495945, 
		791.2269933091371, 805.3527559055118, 823.5879574355174, 867.6269784706922, 
		873.4029042042254, 870.9789208697829, 890.6724726588326, 903.283661041842, 
		926.2737692360723, -329.2700402529599, -303.4650551313007, -294.02115765746873, 
		-277.3285279734987, -263.8477073364537, -251.53258588583714, -309.8315570981352, 
		-288.4736857111926, -269.6933586833222, -259.57240438358417, -243.48590654615262, 
		-227.69771968854286, 0.3734175824175823, -0.046232991612302064};
	double r2_x_list_5[38] = {-856.4060329624023, -850.1621596713424, -858.7842695848531, 
		-863.8126465414849, -861.7855813113264, -858.4606181938143, -644.6619345520702, 
		-643.1692654829036, -651.2725464516891, -637.787303550989, -627.4774384799457, 
		-638.4712696213405, 479.89881749772405, 474.3344493721705, 448.06549095353756, 
		483.4066149807283, 493.1189957259007, 504.6045413790495, 343.2131899664461, 
		347.26739460834517, 347.8228864205163, 334.64951761466085, 349.9204660545003, 
		365.49286467821287, -195.64646838968156, -183.82801998445802, -169.35643718959165, 
		-157.44848976807137, -165.09273749079242, -143.9637014283741, -111.66364712819778, 
		-99.91988225356639, -88.86946532257015, -85.4213122143254, -82.99592526956883, 
		-83.05614059167877, 0.1870072823055469, 0.3998498929209972};
	double r2_x_list_6[38] = {714.1521549598608, 743.9650275438626, 701.6775495773024, 
		738.1013863829955, 729.1273682468772, 692.1928032447482, 783.7037532690817, 
		780.7050587324554, 784.1529850104116, 766.9020298050716, 787.1536401876376, 
		768.1315705846322, -263.899308475801, -276.23300066152694, -264.91289870541425, 
		-256.49001163988845, -283.9411019632678, -303.1030411383376, -509.1322178981568, 
		-506.9140391515214, -498.63848809418414, -494.1557214564309, -521.6202177452501, 
		-527.809123756455, 111.7965665568909, 106.40139871270665, 85.86078200293359, 
		82.93656156317806, 84.2266675710473, 80.19711176708915, 182.5427487138747, 
		161.4446255846372, 163.35009896547092, 164.75920192297303, 153.92756737412805, 
		161.5943438262237, -0.12683061619231847, 0.3013227420125184};

	double r3_x_list_1[38] = {-729.6115182776814, -727.9822239223199, -713.3866047108576, 
		-719.9676905938056, -693.2632554643637, -699.397237006012, -660.7579477178892, 
		-652.5572498202517, -644.1264866465566, -622.4086346890581, -629.3315149077969, 
		-625.2535649999459, 310.02045118102797, 320.7132356463753, 340.56885934268684, 
		341.89810964749967, 372.2920329816179, 407.8121918125557, 375.72229443197136, 
		378.92300121676533, 396.5118947141822, 408.8272974223413, 440.11594228634567, 
		466.08045307565214, -198.41604820874247, -173.2533485437197, -147.9603611552526, 
		-125.92179050196569, -96.72536050303466, -78.04862132006483, -185.9204146509268, 
		-160.41346164092087, -136.2910982072733, -115.02962167188107, -92.4425809869676, 
		-65.86575284027512, -0.5005686205686208, 0.1793660649066054};
	double r3_x_list_2[38] = {-112.3863968504404, -216.53962375398487, -215.53842430025247, 
		-162.38309847791243, -289.1676270524624, -282.79758164013106, -260.82403294992946, 
		-270.62479667766934, -245.48218361968816, -247.2063203742223, -252.37366190244893, 
		-247.47194182181192, 116.27952266824911, 117.02990367432767, 127.83077213603929, 
		131.33449274387328, 156.58495605564872, 160.77402761530072, 150.56309991322678, 
		159.01876489102108, 171.24662631493197, 160.81991354530066, 170.34710682736227, 
		195.34044939250703, -96.16957823277, -80.7579995549138, -46.15721417991429, 
		-38.254550819196254, -27.056044942302705, -11.477599075368474, -73.67578577409364, 
		-74.2993406225632, -51.9481377316726, -41.41782418064736, -34.52922703116133, 
		-30.62538688282973, -1.4762038404726743, 0.15996281800391374};
	double r3_x_list_3[38] = {330.2684747998642, 334.4922021223879, 323.86274892876304, 
		327.1726245681798, 316.41024988189133, 316.60820963399556, 369.18978277585506, 
		370.42002058318917, 357.8473387844799, 347.9817505758351, 340.3381254842202, 
		335.935165712452, -115.94649613629576, -120.35133469774053, -132.56627686365061, 
		-137.67792386338715, -142.47819649869336, -153.02822220512803, -239.70159506861887, 
		-246.66617476946192, -251.59784263826634, -271.0015483716479, -276.9907986338716, 
		-296.5301405094382, 74.24067341035536, 62.908889903256124, 49.87628907564272, 
		42.01269344397423, 27.20038439269274, 15.413260375344493, 126.04882181600914, 
		103.04330059373027, 94.89171510849889, 84.68069468322076, 68.88252322254706, 
		47.41673512061192, 0.057088767870972376, -0.3638258545818951};
	double r3_x_list_4[38] = {796.6084851061835, 789.4748945183146, 772.2589100295521, 
		756.6385707483512, 746.774227303183, 736.3825352494691, 708.7041564792173, 
		694.7518877696994, 678.3696292095958, 697.1544359014749, 673.016026068072, 
		670.5685030377158, -344.74764943187796, -354.6533642775254, -372.3345629037975, 
		-385.0953861376399, -393.57376206227013, -431.6617619808677, -400.29018876841536, 
		-416.1641989769738, -427.7944126363574, -446.62643197530656, -472.17697201148445, 
		-494.77965488367937, 204.08673178055975, 173.3499221819938, 157.12934963501303, 
		119.09632852340366, 99.06432240671712, 73.3946433131928, 194.7739743976619, 
		172.07101678740887, 142.82916172268577, 121.24067400055327, 99.74680540606495, 
		62.84495684067761, -0.08650259067357514, 0.05701766346451792};
	double r3_x_list_5[38] = {427.4830822415736, 409.6684649878598, 424.6847311827959, 
		425.26530153868555, 385.9634504302868, 394.78505084768574, 317.1297133437833, 
		315.17454616329195, 317.6711139251589, 300.9608445066467, 293.10282257236054, 
		297.4123852350704, -211.8393133671354, -217.4455977347601, -222.90921274408208, 
		-230.0127090099158, -239.6143814711399, -260.6241920089888, -149.92208543821835, 
		-167.3667484111138, -156.10877596330587, -174.477517616652, -186.1708983046522, 
		-196.29139232568792, 121.02606007192054, 103.94115623779592, 89.42383821712838, 
		73.14343072664472, 54.99954461187387, 41.02848501187688, 78.98610612189952, 
		56.59743722335287, 52.10372191063237, 40.1161760806151, 20.297091802734215, 
		24.029294555966825, -0.2494386422976505, 0.29554974152061525};
	double r3_x_list_6[38] = {-359.8598550311914, -347.43269528706395, -354.1093616399238, 
		-355.46989440688014, -333.52238948430545, -332.2916084424642, -373.01980358135984, 
		-363.5277490501672, -368.5185873941703, -373.3266725585975, -371.33553726303705, 
		-375.98441791230175, 115.10670608576908, 124.24886844220754, 126.15812254912171, 
		126.65169175608732, 138.07856163661296, 140.79757733041896, 236.94068385473574, 
		238.72070745927618, 241.70999675430073, 253.9193879530747, 265.7073667072359, 
		280.5367303523047, -78.31950914617029, -61.13202302958105, -49.57559469508148, 
		-46.269043531303296, -31.955678491953996, -19.924919607589047, -121.9189508300397, 
		-101.2684943429068, -92.7707587343342, -67.51912702603659, -63.15782662521258, 
		-47.72509244367248, -0.3524513267066461, 0.3320235691623057};

	double r1_y_list_1[38] = {44.55356516607844, 53.45125332413454, 49.63024525342087, 
		62.7443007748185, 44.250554828048394, 46.06605155235809, -37.770805793555155, 
		-46.10813227172059, -45.23973098691806, -44.41149783997798, -52.8073880437355, 
		-39.3827147534646, -79.53284346271238, -81.95964887776273, -74.96212702106095, 
		-62.54212689182242, -68.81280518743017, -61.58892581664588, 60.67794202078579, 
		48.236930628081836, 61.20146294498966, 33.086579633873555, 47.36555741688176, 
		52.809810771807406, 20.97577309553523, 17.920376085501175, 24.209691525343473, 
		36.83933499570654, 19.454894772572956, 35.156275409042394, -9.551327615113848, 
		-5.5589945213317264, -30.268615806618982, -17.75905039950402, -16.51198526317816, 
		-24.418265959190563, -0.315736017385337, 0.531946612171914};
	double r1_y_list_2[38] = {-217.04372726925658, -283.46820308342285, -253.09552513587664, 
		-163.95891289659403, -462.51402627889615, -470.6662777787851, -542.8407188404328, 
		-528.8078677742519, -522.7736076074546, -533.5190302399842, -531.5707549221768, 
		-542.8575804085053, 187.2291765955406, 185.79662285358842, 176.427559484872, 
		169.329713659091, 163.74221444873, 165.62090214734803, 434.03358997911937, 
		411.2325915803415, 399.8250205705415, 379.75619898997184, 383.6093143509371, 
		386.61206999961985, -57.04295146250041, -61.86358491536754, -59.424545170198456, 
		-53.791584174149136, -78.51157059970073, -59.3186296839432, -115.4559528650268, 
		-125.09259678439741, -133.63220782637688, -146.41557913477993, -152.95153132526278, 
		-162.45520162189564, -1.432051030421983, 0.5497287115003779};
	double r1_y_list_3[38] = {-580.238749381173, -586.8841769872574, -585.6984882393313, 
		-596.1061428521466, -602.153422659339, -599.1971530046378, -508.60367326348546, 
		-515.8455638004812, -513.3798673787, -516.1228610387886, -529.0463954146041, 
		-530.7172225743225, 408.2991235218385, 396.0103598060473, 388.33630415349796, 
		385.48584253298, 381.67917860639113, 369.5893411597301, 371.16541876908775, 
		356.7146242735238, 356.9399996103066, 340.78643783131395, 351.3565734028681, 
		333.42593893103435, -102.31494490781233, -111.75811826366623, -126.79386891033363, 
		-134.37383013402422, -153.21475894594002, -169.11116968216294, -83.89960821816021, 
		-99.63117349826717, -100.91978377130633, -106.87029720815144, -117.11223102813855, 
		-125.58091124846351, 0.14876102292768953, -0.10172853361308647};
	double r1_y_list_4[38] = {-38.19033645965442, -36.694165702961755, -28.78671062648732, 
		-33.450579545551136, -43.72708044079923, -40.18954574038912, 43.9119398686222, 
		43.53325732464759, 42.297729897754266, 54.904098562805984, 52.38786633111624, 
		52.288140606757906, 67.5615498629661, 65.70968344965138, 56.8472121271717, 
		67.93211825758817, 57.593470653585086, 69.76816436758872, -55.67227377365214, 
		-61.356798334821974, -51.51088202051051, -61.006991540515116, -50.97663592795095, 
		-67.05166322823425, -16.07259347001616, -6.102102092850544, -18.04919228376002, 
		-33.09421837228649, -12.249722425182597, -30.27763723960328, 23.513895201550966, 
		28.335127723041836, 18.463533088555195, 21.378429612233163, 28.16940775960694, 
		31.9813996985703, 0.09830399216662232, 0.39894140505164133};
	double r1_y_list_5[38] = {691.1513447432192, 686.2895868452629, 701.3889972783113, 
		702.9717239596797, 713.7784126166999, 712.904430626526, 643.5722844613442, 
		644.1809416957019, 650.5210938697167, 653.3823968860569, 664.3676820897938, 
		681.2021462001928, -351.09797405441105, -324.83295274578535, -316.50007916979973, 
		-314.97840147312155, -303.037831726176, -302.7801079648076, -435.0958364479371, 
		-418.006145394362, -412.42650819024004, -396.4435843997054, -406.72661427800404, 
		-400.09159375528424, 85.93105054338922, 83.48973946803866, 106.68970837267409, 
		116.75782980860278, 112.2670394542524, 140.5205526349931, 118.53443646149124, 
		110.23114791500565, 112.294519492786, 126.36627960861786, 152.397304378801, 
		158.2628425608726, -0.1573641851106642, 0.6351605215196968};
	double r1_y_list_6[38] = {709.4267662600062, 725.5331067225939, 714.8951426127446, 
		717.0020768928367, 752.3820246620087, 741.3159932478228, 568.3772877693561, 
		575.9676376156563, 586.1202878579746, 580.574955730435, 601.2903199488861, 
		610.0032240585168, -388.387882053547, -407.3888851202244, -360.07129118545186, 
		-352.9653510429615, -357.10220021170846, -378.7572131495226, -351.5380648087689, 
		-362.0397379458094, -314.0803090924636, -352.3561254699375, -328.63009412692736, 
		-327.86967456867393, 91.58759401035284, 109.20097020097002, 127.6715155945635, 
		132.8069819484464, 151.73158350120354, 156.43365858486558, 71.94455883603217, 
		75.51737378958614, 99.41810441708492, 104.8938946997598, 108.65589728572981, 
		132.91895863058403, -0.23958276388777242, 0.5899484817261651};

	double r2_y_list_1[38] = {-56.943893785720206, -60.064779805223225, -60.697847067557746, 
		-64.25176185214889, -64.40356947732596, -60.19837305969702, 95.89388489984458, 
		95.66024770904164, 88.75789568307528, 92.28147864074356, 94.83054655933427, 
		94.2798392962751, 125.79321680563095, 124.82270508334585, 122.00760217320334, 
		116.46278909126914, 121.17438824978365, 128.2254153897133, -104.65447218612883, 
		-102.92523047758874, -102.74284248351142, -108.72804564846791, -107.25489921330762, 
		-110.66407860823858, -48.747974806485445, -43.50118555433869, -44.80569065786145, 
		-44.85360808438878, -49.41748437687505, -47.52213820686282, 56.31881924390832, 
		42.66229671585123, 38.74835524399195, 49.181964910646826, 52.443903378983194, 
		42.4411634662203, -0.2957828352070198, 0.35437637833864244};
	double r2_y_list_2[38] = {1258.4031529736699, 1294.1320133890295, 1357.11160779087, 
		1204.437644810881, 1083.588308328305, 1098.3697523720666, 1153.3821074595721, 
		1186.6183314179714, 1192.6146876470777, 1183.72690761534, 1141.2541860710585, 
		1125.3972550836675, -319.1221506153994, -320.88669244133837, -340.5170090647311, 
		-357.14968338366236, -353.9171053231481, -399.0503376304483, -812.2535751597637, 
		-791.6681479806211, -798.1314889444456, -808.1908086517105, -826.5428674943596, 
		-839.1445265448974, 171.93046039938812, 148.4627887249154, 139.7476594878341, 
		114.49362115373145, 87.2947330361798, 64.94139279439007, 299.60365337914203, 
		286.28575939653103, 277.3727438499077, 254.94733496740497, 243.95580820399934, 
		256.28764606055086, -0.5012857529898983, 0.0729052969502407};
	double r2_y_list_3[38] = {1372.1786632724256, 1370.3699392841572, 1369.8894289254729, 
		1373.6851397881242, 1329.787403228115, 1354.852257253043, 1116.4432758089704, 
		1125.5472986566901, 1135.3539586730258, 1123.2619402498754, 1109.2920696739982, 
		1114.8783861191462, -751.8482403182506, -748.1608420803533, -739.9214402526609, 
		-751.9970069729526, -770.1451725563436, -783.5243742008487, -699.6598351296547, 
		-692.0617187876813, -717.3391318574834, -714.9402993373554, -730.0775898670859, 
		-750.5212230610035, 296.8398760654804, 276.82910795514414, 256.2883064091259, 
		248.86217104313232, 236.43399994159503, 227.7923873559882, 235.21403488352735, 
		209.6107094749228, 214.6232753756987, 197.91955892305674, 190.41450602321336, 
		181.8233821763024, 0.24627160637770715, 0.0077221334108416};
	double r2_y_list_4[38] = {61.398702328366085, 64.06372257978353, 62.39687403197547, 
		62.60281240178665, 61.0344584626755, 67.7820739651047, -83.76206751813868, 
		-91.93424628740786, -87.15765885757571, -90.04741978360335, -85.91508868402502, 
		-92.49507511611591, -134.86398790464062, -129.75150146654892, -125.58985192103609, 
		-129.49898619848932, -131.3646445137756, -130.05684397022395, 111.84573764870288, 
		104.28003465832353, 108.00643902738489, 107.1514529450925, 113.63004589399998, 
		109.37343931003204, 45.70700467520487, 41.37578429181707, 49.031918980699174, 
		49.07431396360019, 46.95917320520675, 44.76268210813379, -50.2937540199147, 
		-50.900315818317864, -49.76752389792357, -48.84845026021506, -48.495535074038884, 
		-52.51740702293614, 0.09394625176803374, 0.2208538137667678};
	double r2_y_list_5[38] = {-1362.638713238588, -1353.93557706537, -1366.027455329636, 
		-1354.1779863707297, -1360.4518924806475, -1366.7311588076202, -1299.2678245002257, 
		-1308.7642361031815, -1299.293783750305, -1278.9549407774591, -1274.5258044930174,
		-1287.8853787382743, 586.9973294449867, 579.2566512723156, 560.172494050099, 
		590.261838404889, 607.369796312948, 627.4462971036114, 795.1306441257075, 
		812.4059558170541, 810.9656423946102, 802.0138517504004, 829.7973573828617, 
		856.3963106996339, -246.29669755670898, -224.52524310225326, -215.9382944037796, 
		-191.1188057863957, -200.89565742614042, -172.2856310203924, -284.5245515716437, 
		-268.74697882947925, -251.61020492467358, -229.42859019181208, -222.66562071237746, 
		-223.63194382350665, 0.15988872180451147, 0.5271497362990137};
	double r2_y_list_6[38] = {-1383.5022140483281, -1363.4376115615455, -1351.7892255628103, 
		-1395.8523921613375, -1358.927482047914, -1349.75545489067, -1109.4635989941285, 
		-1133.1423764107535, -1111.533162175735, -1165.2375155259208, -1139.8921774194516, 
		-1162.575237019013, 719.2526671823075, 706.5511442474699, 720.3258024586372, 
		690.7566638625455, 742.0555913286113, 753.8715084414939, 678.5393806303787, 
		671.6940095670044, 682.463268501799, 671.4263288533451, 694.9909636629782, 
		720.3043119684265, -295.63054348951533, -265.9412511616616, -247.8340156085652, 
		-235.36221753635346, -219.2727410264822, -219.28535533789986, -231.14113314042265, 
		-196.44537584169274, -204.59842212705686, -185.8714460973991, -173.6285479234974, 
		-167.38592280777092, -0.17095108695652197, 0.6682140375260599};

	double r3_y_list_1[38] = {36.79520087618823, 29.221446249020005, 30.04613781166438, 
		29.062551584254493, 27.92914305867464, 24.963178027179424, -45.29487841173125, 
		-39.93859511928156, -46.37341366225235, -41.848704829395615, -36.15467562314075, 
		-39.68808959646856, -58.83141520095705, -54.35427713969278, -57.72783700334509, 
		-59.74801553817696, -62.56785873626262, -61.126621309775715, 44.14161137141184, 
		37.94046392885309, 47.826562459048205, 41.54445464933002, 48.15393004808038, 
		49.64552128377534, 27.848908766697974, 33.500108310255854, 23.2839994965329, 
		20.899492806820746, 18.82390605571031, 20.738614859776874, -33.17957362205155, 
		-21.367701025282543, -24.934323538908714, -22.41260678153904, -14.151753041318287, 
		-11.743150125942094, -0.29927086840735895, 0.019270477421737892};
	double r3_y_list_2[38] = {-170.6094003225735, -263.9358312179902, -273.47509437175404, 
		-150.80589561252668, -421.30624724024733, -419.8893213212218, -521.4727312652215, 
		-534.7049502111984, -505.0810747195753, -505.4684568996993, -489.42999373863154, 
		-490.7997655387094, 127.64048009068165, 130.90112877555356, 143.81249376933124, 
		154.97957303283374, 190.964709655094, 193.9542356987282, 367.91450457426345, 
		375.30167154234084, 390.6879276757768, 386.71422957187144, 407.02474366324896, 
		438.146702050823, -113.84325135372995, -94.59302151106652, -62.78380347905494, 
		-38.383851875085895, -21.27636212540378, 3.5979384225153552, -188.31094522189494, 
		-169.39648351553956, -140.7315709171677, -103.46655952153378, -105.66744925448307, 
		-82.07383411134197, -1.425789871504155, 0.04976688258795229};
	double r3_y_list_3[38] = {-588.0420207766072, -566.4370721594644, -550.7634854928542, 
		-551.9594327251682, -532.5818726085479, -528.541254926412, -498.7727541371157, 
		-507.7563115483506, -487.8536471855557, -485.1759286327101, -486.4033102535411, 
		-482.8422516895646, 312.6809100527879, 327.78649491441365, 338.8875704141718, 
		349.69183841018287, 374.99008415668436, 386.33508857324136, 312.6568330393177, 
		321.1234928615406, 352.1068379174128, 349.582964076454, 372.8050113453978, 
		380.5362685577145, -171.6355217786405, -158.69676368625937, -133.2945480485965, 
		-97.0618408875979, -79.65287134528006, -60.82244449538689, -152.4954301424928, 
		-132.69902668140003, -114.96391976261373, -86.01500667072804, -69.34910462026448, 
		-51.92675832918957, 0.14249222475637557, -0.5661721384205859};
	double r3_y_list_4[38] = {-32.02643782698647, -27.960398305305716, -27.235133080660944, 
		-29.598811559235173, -28.63413389943571, -25.588320747715215, 48.07582260371953, 
		46.80297825992409, 43.122977674180675, 45.6081450143796, 43.44081647455994, 
		38.73030790433984, 57.318311805154394, 55.32594442258903, 54.77620262356379, 
		63.627171382141114, 63.05859620409694, 66.16406582858542, -50.40646808991801, 
		-49.931755110670224, -55.759011030928264, -56.89167392276585, -53.90374246654744, 
		-60.46226351719588, -27.421348682554395, -25.660005343319938, -24.77606634771243, 
		-22.613235256582584, -19.801635356152815, -18.79869100950731, 29.113555262085626, 
		25.30553997852431, 25.925596820208128, 21.084044704126853, 23.439535788699487, 
		18.318660490777063, 0.09042193990332051, -0.11925148022709};
	double r3_y_list_5[38] = {661.6591599739525, 645.9464296204338, 650.9834154777351, 
		652.4796682788063, 625.2067367164669, 626.3674293362451, 637.6486178967648, 
		611.9257878952185, 628.4502023840395, 605.0119415754821, 591.7425907620652, 
		596.8963817160673, -253.7336793472989, -264.42864532682836, -274.44804498028816, 
		-283.9558819705473, -291.7864616700135, -325.50497622199333, -360.37291393696364, 
		-374.82930725884415, -380.4314607376423, -404.02003297391025, -421.7669332626009, 
		-440.03124850608054, 156.57946403125726, 127.00367895564932, 115.03947249784471, 
		87.3985218306104, 60.59408311641944, 44.78275221248427, 193.10321631280243, 
		155.18938138435996, 143.6992106987761, 115.66991364625014, 91.18395417902225, 
		66.22682701899, -0.13174750830564794, 0.14202486414054913};
	double r3_y_list_6[38] = {667.8845490735296, 686.4848171287185, 643.4140271349576, 
		675.056831254632, 653.9318541451668, 611.7722453565513, 581.717403372583, 
		581.0085609402959, 566.9732654068346, 545.6226352156298, 561.3014461701356, 
		539.9515709387879, -300.1422386693875, -325.8114624159576, -318.85786715520726, 
		-326.5373733205694, -356.4670050761422, -388.2971574248819, -312.62503231657496, 
		-304.4810996918788, -324.60964165643867, -332.91284265964543, -355.29361464703294, 
		-381.0440391391126, 168.03884627426422, 147.93327349532322, 118.20414280879406, 
		93.82819145141539, 79.2598827360311, 61.6405101720507, 144.33900198969553, 
		113.23780269287857, 102.94560811717652, 93.48417592675342, 62.990767021248416, 
		60.98975826997636, -0.2573330132052822, 0.11402817446870299};


	double r1_cy_list_1[38] = {-141.4576514858345, -178.2685596716051, -214.6818286144013, 
		-243.93177887952015, -274.20959097127843, -304.64806386161945, -184.17569487095136, 
		-187.97882522886266, -280.102767833808, -306.72846818942855, -344.035698590056, 
		-371.5983224828416, 76.70369848808315, 63.65743928018492, 78.03110942530043, 
		68.69822961198008, 60.528334107464104, 63.30869400381471, 215.3802357769955, 
		204.43135974548886, 189.60767393578192, 169.61484633106323, 183.64548300718502, 
		174.9817419469391, -30.096683127378498, -6.760534670236268, -14.763901566405991, 
		-24.281776654982338, -36.75370981804845, -58.77565644616848, -36.779964219114504, 
		-42.18980004138672, -46.21901297832562, -95.94628712286377, -80.28579636854153, 
		-95.53659392970079, -0.22531868131868135, 0.5185511171293161};
	double r1_cy_list_2[38] = {-46.069568674219454, -92.07108101928793, -88.53747313387589, 
		-105.25339097863025, -139.39651180664373, -137.55764669461905, -136.1727985836908, 
		-144.13152526974818, -173.8634135898651, -267.3336210890718, -295.773104177249, 
		-320.7898253736439, 3.4697038935574938, -7.066573896687885, 29.25977340288256, 
		33.30789968531769, 11.28596484280206, 17.066460381337833, 180.11656102948166, 
		171.2170786890846, 177.82088831099372, 165.10584028085088, 160.2612161806743, 
		159.93616280333868, -13.219996825110456, 0.817712648439624, -8.128202459489103, 
		-46.88620520134171, -20.289889883617775, -8.250439185829407, -51.544492365843325, 
		-13.341948523636916, -32.12236231779781, -44.89679873339509, -21.438311860713043, 
		-51.481276594772226, -1.475621393788107, 0.42933722897124393};
	double r1_cy_list_3[38] = {-90.28551300498498, -123.82716649784675, -171.36194535281948, 
		-208.64063069937743, -259.1417163507497, -283.08174934190583, -141.9802899128499, 
		-197.65469583940921, -222.79372020516166, -269.5522290971319, -315.07474558391755, 
		-331.0325563856402, 103.79188159906619, 102.65672805687848, 91.42805292285448, 
		84.09204197355609, 76.05016410608948, 82.91319132818978, 193.96136905940864, 
		186.46648015771507, 188.05786571990552, 184.57551633080527, 155.3194879471347, 
		171.81999117008297, -13.149429962213787, -80.52569985566043, -4.923302549817578, 
		-26.370168086480817, -45.29046875086115, -34.664081738370896, -68.70766233224623, 
		-52.26057627259229, -72.96496177575088, -39.55504590614322, -39.56360015411303, 
		-41.28987626409952, -0.11142152255639104, -0.3620571428571428};
	double r1_cy_list_4[38] = {-138.1571065974888, -188.40428975979103, -214.41086253551862, 
		-225.69115272383692, -290.53332930697957, -347.16770513679603, -207.76379761269754, 
		-252.2685335778259, -284.45385548115325, -314.92152389387184, -346.06827795449965, 
		-407.2853263370265, 69.24328355691341, 88.75633994285761, 84.91534897607698, 
		101.62962495784325, 90.25886863335643, 93.59055691263893, 227.03508062435867, 
		233.74600049012918, 232.063041699652, 201.22638031406177, 211.7856962329913, 
		209.93074374265393, -49.658924973593486, -32.27680203352017, -26.576579925650577, 
		-35.46448617011083, -56.72949745015336, -42.013123281072694, -59.05564270932419, 
		-44.586877564579254, -57.45159050217379, -86.35867309754798, -109.13450863606369, 
		-65.95860481186054, 0.02388004658385096, -0.19386709601873567};
	double r1_cy_list_5[38] = {-130.11979561009736, -132.86224191216758, -204.40673316976756, 
		-250.85030518158595, -297.41842375524755, -327.1958317945988, -149.0794215725091, 
		-201.86254000800025, -249.5993978148894, -295.4834239119242, -357.2629024293768, 
		-382.01923524037136, 76.30248812455787, 77.48567100310359, 76.64380563627856, 
		64.50109989950656, 76.85912727216501, 76.79808823127601, 207.1240805999035, 
		207.63630704683592, 222.29168966759798, 195.89623827616123, 176.78488471120235, 
		198.54998204072592, -34.92532597537961, -12.233133554806182, -48.98409113009933, 
		-13.83689594139151, -25.23503631223994, -47.39136229443907, -46.67325031327607, 
		-58.310427429246076, -80.18128855554531, -68.37164584779063, -70.4379716033875, 
		-80.93399691913861, 0.17483584738243127, 0.1851643472745587};
	double r1_cy_list_6[38] = {-98.90212228886024, -149.26578194844973, -188.167216616648, 
		-255.82758866207828, -215.96000842249822, -295.38118607262106, -203.45424292425616, 
		-215.87136890300633, -240.9909355352059, -277.5268032818735, -360.60893824078386, 
		-385.3638638046539, 53.24902831138591, 95.13165495527213, 65.96356880069928, 
		72.78499934306879, 81.84841526206486, 40.413780932810326, 209.32441733562013, 
		205.644964897095, 179.37087823769355, 191.8013043698814, 183.93001618267454, 
		173.99571593481198, -12.374574289826372, -11.859754216337322, -38.17595436595012, 
		-15.96066368164108, -19.675143129987696, -17.698973116739374, -33.624455788836734, 
		-20.154000399339097, -67.02729801935837, -64.59338230263653, -48.892665085454304, 
		-41.53529470830392, 0.03275416968817949, 0.4900249596241374};

	double r2_cy_list_1[38] = {799.8136374669375, 815.2557852261941, 818.227320785033, 
		807.0744104274005, 801.724394222528, 781.4591466260218, 993.3424988265316, 
		992.789675297602, 965.9287894851088, 1009.3357590684798, 972.9927126540852, 
		937.2716300979492, -36.863008477045184, -99.7800166693138, -171.00987375464084, 
		-238.2630387217772, -321.971256197936, -379.66870706434497, -499.86034627151344, 
		-598.5567149168833, -627.7182018914302, -707.0869663970127, -799.750713457589, 
		-856.1347340059494, 105.86310720546659, 99.77330126803983, 93.42125596899315, 
		59.32536071380437, 97.15334968504264, 51.85125950732322, 252.16951309745696, 
		219.19664864101372, 234.93424591538616, 222.50892806129798, 215.92558277244825, 
		213.28916135971951, -0.16446062812926715, 0.38318526922069995};
	double r2_cy_list_2[38] = {550.5641788740272, 618.5618839605736, 646.5165544657232, 
		512.0813418968748, 397.7563352241459, 338.79856935763723, 857.8074256383043, 
		849.504107197622, 865.0721300927144, 875.8216756639679, 860.5242770192453, 
		827.8896505831362, 96.46710193099045, 34.89298455869971, -56.60133969559098, 
		-131.71676350053508, -176.1724705629395, -248.79350624299218, -488.72022436424555, 
		-550.8559034610172, -637.2408120735886, -687.1132497326724, -782.320421682794, 
		-839.9257593832299, 41.102430259078375, 45.92652322491949, 57.709955400315735, 
		17.798176799714838, 10.782426605448741, 20.32376742988798, 255.09304003767738, 
		263.1733000838284, 224.45120484560874, 209.03108264276437, 213.58920109645777, 
		219.33509483988678, -0.9682289743159307, 0.2086260793529347};
	double r2_cy_list_3[38] = {718.2561192792184, 700.4863583518293, 707.826593880577, 
		711.1129869088045, 706.3812690222973, 712.2531684052813, 897.6523511224514, 
		875.013785092968, 901.0246134954918, 906.4742686763394, 882.2969701317538, 
		866.3867332623715, -33.48493814105154, -85.32330119696462, -174.3409387297287, 
		-234.84855935285464, -309.1076358492777, -360.4601707790226, -512.3227945275754, 
		-565.5437214085422, -641.2103087378459, -715.3692845486657, -775.4082829697805, 
		-873.3094853491297, 75.79674064392123, 85.90348023283144, 74.2517136405771, 
		52.21060363707977, 63.79626679692559, 42.67923961911137, 245.44812559506187, 
		246.04997976673786, 205.75770025665216, 230.52869775590116, 196.59516303210623, 
		219.6877872596067, 0.02189999386966906, -0.23398552666845318};
	double r2_cy_list_4[38] = {818.1735374444205, 820.969450170317, 821.5341203864182, 
		817.5249910481072, 825.2297999684263, 797.8119526194264, 989.3989593148489, 
		991.5329840388678, 992.568758947264, 1001.751403933577, 1012.5223322383705, 
		1009.009952507402, -51.67584560642092, -118.75069206844904, -195.57513376639866, 
		-258.4396343264295, -328.3536303201884, -402.034217482881, -553.8090086116235, 
		-613.1743513169629, -679.6450607671795, -755.8653946557895, -846.3646700875972, 
		-924.9212131845882, 110.45700032940806, 105.93952430436474, 92.37445070824677, 
		86.3055357496533, 76.94615361126915, 61.65303173427071, 267.37389101353335, 
		257.2895396438892, 239.6894649057038, 235.33564343080633, 243.60367273202974, 
		227.81206944156807, -0.05709123883928566, -0.053940814327690205};
	double r2_cy_list_5[38] = {735.10069289959, 735.4566847688271, 733.3704024176409, 
		690.941988786354, 747.0545710814138, 742.9049428481424, 873.0311066812595, 
		895.9362102782409, 890.706650104963, 897.2366608108258, 897.6213081323405, 
		903.2054671259934, -20.052602324577208, -77.72754537072547, -158.43381244100448, 
		-234.68689335506372, -278.1467336772055, -358.974584945807, -500.13163017557025, 
		-573.479290618048, -613.1329029020495, -674.1919874277282, -750.1671434280129, 
		-856.0961799642196, 98.63684162230241, 85.12801598847969, 83.97981576514661, 
		53.55317022073511, 48.29887685545515, 53.56802372388546, 258.36161475976877, 
		236.05401841301583, 258.31563463690355, 220.76438056374317, 203.91337300529943, 
		206.16520339789787, -0.025448805858151822, 0.20557299843014107};
	double r2_cy_list_6[38] = {667.8429971121751, 672.581868793049, 643.7555193549819, 
		645.3666384065593, 686.9144045996571, 647.2542422740833, 860.2895725910731, 
		840.2643282219623, 846.6224753241364, 840.8865041230099, 857.8751060220526, 
		875.4226672353867, 16.083092535101322, -73.32465436469579, -106.18980098607256, 
		-169.147770383814, -246.36803564620567, -311.3808783572681, -475.44561426263465, 
		-511.6727705106876, -537.643016008971, -635.6297920390338, -722.0349125436697, 
		-781.3076748244653, 67.36916442221367, 76.46859128744498, 57.088627801843714, 
		63.417655795838535, 25.549612802505372, 41.93996164292129, 239.23735072823928, 
		232.16961105524382, 197.47103973272118, 209.94882504329107, 196.98730740050476, 
		204.82016726982516, -0.026411960132890402, 0.37052878156326396};

	double r3_cy_list_1[38] = {-600.9561192226133, -566.7920624564191, -558.43125243337, 
		-578.205753981874, -550.1993035080011, -533.4099862318033, -676.2052114354635, 
		-671.1109877272288, -670.1492666947831, -634.9468406547603, -639.1970853616779, 
		-638.2387808809196, 134.15852410010018, 156.8200310155018, 154.85172072541866, 
		155.37171206774752, 155.65228039044774, 194.79868729616476, 396.7091861162363, 
		382.6474902624039, 409.08555803028185, 434.76541661336415, 458.1881713332489, 
		499.4020182775057, 138.59722778363212, 60.3300081867628, -9.5390364132016, 
		-118.50949051504048, -151.87052341189536, -254.06655035184752, 35.84323446193497, 
		-61.06150610179853, -96.96027955166068, -173.65378644730248, -251.7610438917826, 
		-320.48144881926066, -0.5680132971743508, -0.16562330504767753};
	double r3_cy_list_2[38] = {-169.23275010545376, -177.00446815196256, -163.6973687579407, 
		-99.03987533695931, -256.36327695459204, -246.70254699066368, -535.1143515456401, 
		-524.4444947494185, -514.0632325812408, -508.41132960610616, -515.0250810888294, 
		-502.40559202789586, -8.690425697078581, 23.277897087224744, 26.195388591692677, 
		27.303668017920074, 59.948260744849335, 72.34997679684238, 376.2871495906011, 
		421.7195370936039, 388.9869096133067, 425.8177520029277, 446.93284142341633, 
		478.33120011796575, 159.6712151418308, 89.92032036615092, 48.81581015994185, 
		-49.285884992469875, -119.2426433631713, -171.8112142576746, 38.427444586520096, 
		-21.90795175294795, -119.29300226487908, -178.0703143122243, -264.497908350575, 
		-331.9724571676423, -1.1096245144583512, -0.16255243983219256};
	double r3_cy_list_3[38] = {-498.2319742734044, -519.2980401729058, -486.6302387539704, 
		-492.1797191381397, -483.0747568685331, -481.40067136007815, -577.1413910838817, 
		-592.8363698108924, -575.1115851423704, -562.5466961761692, -542.5961054634645, 
		-547.4698112692627, 139.4259244443607, 161.18284311508046, 156.4922670067499, 
		171.4502250939512, 181.60300580938815, 199.4274716285613, 407.91265245196973, 
		418.96343870489534, 428.17309985242537, 450.3007028843849, 496.4720578984934, 
		480.8821902628664, 127.41413979981249, 68.60195729540482, -12.379246850036623, 
		-93.07199102350165, -156.50663178301946, -254.22776985214978, 26.560524536179287, 
		-29.915099374441752, -137.74594507337832, -167.52413616048796, -276.2413639394666, 
		-318.5917311082393, 0.6131879655445049, -0.3136619601328906};
	double r3_cy_list_4[38] = {-618.549430877307, -585.2284449607471, -583.954289112947, 
		-595.5328738216783, -567.5832480975348, -563.5122618076466, -699.4147960319991, 
		-681.4432645284894, -658.2839659001138, -661.442058367889, -647.1589651149891, 
		-642.8790622979142, 152.96597343572762, 166.92239328706398, 161.05073663459427, 
		188.8439060372218, 204.00072087495005, 222.91178863503262, 423.83070859183374, 
		431.6504687024195, 442.98299220839726, 475.1522695399241, 494.63151847737413, 
		534.8759963616827, 133.90178781297868, 59.47573357504433, -20.01575697032544, 
		-95.9867105138593, -163.37866805880805, -255.07672821727726, 29.129496141682864, 
		-41.75105842808051, -116.88235964489849, -185.81880947091216, -247.49549023446764, 
		-335.0253345084909, 0.3596804884975858, 0.4785123878493839};
	double r3_cy_list_5[38] = {-603.6328416683876, -603.2867958772329, -603.649463717633, 
		-630.2869735733453, -586.6464035990023, -583.7518749216749, -728.1823458491662, 
		-708.7633005983298, -705.1646260772868, -670.5023264354004, -676.9175254633269, 
		-649.9315055196628, 131.08092312850985, 145.27487433698536, 130.4188564413406, 
		142.17577274413762, 184.74300808079528, 187.8862019183292, 406.01349376382564, 
		417.12210012210005, 443.93863776722816, 451.5920607539104, 497.3932037079828, 
		483.7107098318685, 142.59455814886024, 59.5823000283454, -11.996418890488215, 
		-112.19169784353757, -179.43219345322564, -238.78232618583496, 33.35724842182441, 
		-54.26877989789811, -90.8514328433718, -183.70973657775778, -271.3072910280319, 
		-310.19885317383466, -0.2590417003942869, 0.7672077557887989};
	double r3_cy_list_6[38] = {-522.6133925824208, -504.2767388263125, -539.8758425223044, 
		-517.8356702449064, -487.8114329887455, -515.9537817402093, -583.2191175610043, 
		-614.5426497064154, -620.5019742877356, -616.8740296518142, -588.0504125620947, 
		-595.4730826891011, 109.65721451874735, 94.38771379256522, 128.26140939145418, 
		140.54383992214423, 141.21377639568468, 161.25688540864405, 330.02098644240795, 
		362.96102086697687, 397.81223922451306, 410.7895609756453, 399.45988649126093, 
		445.8106878639685, 143.38876990677878, 72.46774702375174, -14.625163515619809, 
		-71.4201179801075, -168.07728369154262, -236.12992326808825, 61.16294094165584, 
		-16.073039788374786, -95.13962010513376, -150.66330722827365, -243.17916455477416, 
		-296.67786016556096, -0.6447751807986585, 0.40368677042801543};

	// positions with may_2018_engineers alignment, calculated by Latif Kabir with coatjava 5c.6.9
	// in October 2018
	double sector_1_list[38] = {-900.73, -947.81, -947.58, -927.11, -896.6, -900.36, -883.41, -886.38, 
		-882.05, -836.06, -800.2, -831.78, 364.55, 397.85, 432.8, 465.14, 500.74, 512.01, 528.73, 
		519.36, 607.1, 467.32, 558.0, 574.19, -191.18, -326.68, -118.44, -270.71, -131.67, -272.77, 
		-163.55, -279.95, -165.91, -273.35, -148.95, -244.24, -0.3633085, 0.2399};
	double sector_2_list[38] = {-2020.0, -2235.82, -1943.68, -1827.46, -1605.47, -1559.88, -1438.69, 
		-1445.69, -1441.21, -1375.23, -1345.33, -1332.06, 402.24, 416.23, 456.68, 547.35, 596.84, 
		639.85, 888.63, 863.82, 982.7, 894.56, 983.81, 941.18, -303.01, -354.25, -155.79, -276.93, 
		-115.31, -146.67, -392.71, -428.66, -325.68, -382.17, -261.61, -305.36, -1.2439781, 0.11855};
	double sector_3_list[38] = {-1577.41, -1603.87, -1627.87, -1618.07, -1564.76, -1553.56, -1431.65, 
		-1442.93, -1447.04, -1400.07, -1349.58, -1377.19, 747.5, 776.31, 829.4, 855.09, 891.03, 
		865.59, 896.37, 866.28, 989.47, 875.56, 987.38, 958.27, -347.61, -433.81, -259.37, -391.98, 
		-194.97, -297.97, -328.16, -376.68, -282.08, -355.39, -251.1, -318.9, 0.21464895, -0.34659438};
	double sector_4_list[38] = {-1088.0, -1138.28, -1143.11, -1138.48, -1127.37, -1116.77, -980.63, 
		-1019.84, -1023.94, -969.95, -946.68, -996.61, 575.56, 558.91, 565.42, 553.04, 556.28, 
		552.32, 608.55, 612.64, 675.15, 564.73, 626.08, 603.45, -172.2, -273.06, -147.71, -308.3, 
		-184.01, -292.81, -124.52, -235.03, -115.23, -269.44, -186.98, -286.28, 0.1516323366, 0.09946132};
	double sector_5_list[38] = {535.68, 488.25, 497.33, 505.83, 543.37, 526.96, 421.56, 401.81, 398.18, 
		433.96, 476.86, 448.52, -281.29, -267.3, -207.34, -273.06, -220.55, -241.16, -259.02, 
		-273.98, -168.22, -311.71, -223.17, -243.77, 70.99, 11.59, 112.52, -41.45, 83.41, -22.7, 
		128.04, 4.3, 72.44, -33.57, 51.14, -26.74, -0.024399627303056937, 0.4421601082181993};
	double sector_6_list[38] = {160.1, 105.0, 112.21, 112.37, 118.72, 103.32, 87.77, 77.73, 110.31, 
		136.97, 131.07, 107.01, -48.17, -51.21, -29.44, 78.82, -23.12, -67.85, -45.56, -66.3, 
		25.01, -88.94, -17.1, -87.48, -6.3, -97.74, -11.41, -88.06, -21.67, -98.07, 57.72, 
		-95.98, -0.06, -71.49, -22.45, -134.54, 0.2217161768182174, 0.47115595680651445};

	double mag_A = 0;
	double mag_B = 0;
	double product = 0;
	for (int i = 0; i < 36; ++i)
	{
		double value_A = r3_x_list_1[i];
		double value_B = r3_cy_list_1[i];
		product+=value_A*value_B;
		mag_A+=value_A*value_A;
		mag_B+=value_B*value_B;
	}
	double dot_product = product / (TMath::Power(mag_A,0.5)*TMath::Power(mag_B,0.5));
	// cout << dot_product << endl;

	double current_position;
	if (sector == 1) {
		current_position = sector_1_list[i];
	} else if (sector == 2)	{
		current_position = sector_2_list[i];
	} else if (sector == 3) {
		current_position = sector_3_list[i];
	} else if (sector == 4) {
		current_position = sector_4_list[i];
	} else if (sector == 5) {
		current_position = sector_5_list[i];
	} else if (sector == 6) {
		current_position = sector_6_list[i];
	}

	// desired vertex position is actually the position of the downstream target wall
	// double desired_positions[38] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
	// 	0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4.72891, 5.69459};
	double desired_positions[38] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
		0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -0.2229635, 0.4054434};

	double value;
	if (i < 35) {
		if (sector==1) {
			value = ((1/shift)*(par[0]*r1_x_list_1[i]+par[1]*r1_y_list_1[i]+par[2]*r1_z_list_1[i]+
				par[3]*r2_x_list_1[i]+par[4]*r2_y_list_1[i]+par[5]*r2_z_list_1[i]+par[6]*r3_x_list_1[i]+
				par[7]*r3_y_list_1[i]+par[8]*r3_z_list_1[i])+(1/rot)*(par[9]*r1_cy_list_1[i]+
				par[10]*r2_cy_list_2[i]+par[11]*r3_cy_list_3[i]))+current_position;
		} else if (sector==2) {
			value = ((1/shift)*(par[0]*r1_x_list_2[i]+par[1]*r1_y_list_2[i]+par[2]*r1_z_list_2[i]+
				par[3]*r2_x_list_2[i]+par[4]*r2_y_list_2[i]+par[5]*r2_z_list_2[i]+par[6]*r3_x_list_2[i]+
				par[7]*r3_y_list_2[i]+par[8]*r3_z_list_2[i])+(1/rot)*(par[9]*r1_cy_list_2[i]+
				par[10]*r2_cy_list_2[i]+par[11]*r3_cy_list_2[i]))+current_position;
		} else if (sector==3) {
			value = ((1/shift)*(par[0]*r1_x_list_3[i]+par[1]*r1_y_list_3[i]+par[2]*r1_z_list_3[i]+
				par[3]*r2_x_list_3[i]+par[4]*r2_y_list_3[i]+par[5]*r2_z_list_3[i]+par[6]*r3_x_list_3[i]+
				par[7]*r3_y_list_3[i]+par[8]*r3_z_list_3[i])+(1/rot)*(par[9]*r1_cy_list_3[i]+
				par[10]*r2_cy_list_3[i]+par[11]*r3_cy_list_3[i]))+current_position;
		} else if (sector==4) {
			value = ((1/shift)*(par[0]*r1_x_list_4[i]+par[1]*r1_y_list_4[i]+par[2]*r1_z_list_4[i]+
				par[3]*r2_x_list_4[i]+par[4]*r2_y_list_4[i]+par[5]*r2_z_list_4[i]+par[6]*r3_x_list_4[i]+
				par[7]*r3_y_list_4[i]+par[8]*r3_z_list_4[i])+(1/rot)*(par[9]*r1_cy_list_4[i]+
				par[10]*r2_cy_list_4[i]+par[11]*r3_cy_list_4[i]))+current_position;
		} else if (sector==5) {
			value = ((1/shift)*(par[0]*r1_x_list_5[i]+par[1]*r1_y_list_5[i]+par[2]*r1_z_list_5[i]+
				par[3]*r2_x_list_5[i]+par[4]*r2_y_list_5[i]+par[5]*r2_z_list_5[i]+par[6]*r3_x_list_5[i]+
				par[7]*r3_y_list_5[i]+par[8]*r3_z_list_5[i])+(1/rot)*(par[9]*r1_cy_list_5[i]+
				par[10]*r2_cy_list_5[i]+par[11]*r3_cy_list_5[i]))+current_position;
		} else if (sector==6) {
			value = ((1/shift)*(par[0]*r1_x_list_6[i]+par[1]*r1_y_list_6[i]+par[2]*r1_z_list_6[i]+
				par[3]*r2_x_list_6[i]+par[4]*r2_y_list_6[i]+par[5]*r2_z_list_6[i]+par[6]*r3_x_list_6[i]+
				par[7]*r3_y_list_6[i]+par[8]*r3_z_list_6[i])+(1/rot)*(par[9]*r1_cy_list_6[i]+
				par[10]*r2_cy_list_6[i]+par[11]*r3_cy_list_6[i]))+current_position;
		}
		value = 0*value;
	} else { // vertex
		if (sector==1) {
			value = ((1/shift)*(par[0]*r1_x_list_1[i]+par[1]*r1_y_list_1[i]+par[2]*r1_z_list_1[i]+
				par[3]*r2_x_list_1[i]+par[4]*r2_y_list_1[i]+par[5]*r2_z_list_1[i]+par[6]*r3_x_list_1[i]+
				par[7]*r3_y_list_1[i]+par[8]*r3_z_list_1[i])+(1/rot)*(par[9]*r1_cy_list_1[i]+
				par[10]*r2_cy_list_1[i]+par[11]*r3_cy_list_1[i]))+current_position-desired_positions[i];
		} else if (sector==2) {
			value = ((1/shift)*(par[0]*r1_x_list_1[i]+par[1]*r1_y_list_1[i]+par[2]*r1_z_list_1[i]+
				par[3]*r2_x_list_1[i]+par[4]*r2_y_list_1[i]+par[5]*r2_z_list_1[i]+par[6]*r3_x_list_1[i]+
				par[7]*r3_y_list_1[i]+par[8]*r3_z_list_1[i])+(1/rot)*(par[9]*r1_cy_list_2[i]+
				par[10]*r2_cy_list_2[i]+par[11]*r3_cy_list_2[i]))+current_position-desired_positions[i];
		} else if (sector==3) {
			value = ((1/shift)*(par[0]*r1_x_list_1[i]+par[1]*r1_y_list_1[i]+par[2]*r1_z_list_1[i]+
				par[3]*r2_x_list_1[i]+par[4]*r2_y_list_1[i]+par[5]*r2_z_list_1[i]+par[6]*r3_x_list_1[i]+
				par[7]*r3_y_list_1[i]+par[8]*r3_z_list_1[i])+(1/rot)*(par[9]*r1_cy_list_3[i]+
				par[10]*r2_cy_list_3[i]+par[11]*r3_cy_list_3[i]))+current_position-desired_positions[i];
		} else if (sector==4) {
			value = ((1/shift)*(par[0]*r1_x_list_1[i]+par[1]*r1_y_list_1[i]+par[2]*r1_z_list_1[i]+
				par[3]*r2_x_list_1[i]+par[4]*r2_y_list_1[i]+par[5]*r2_z_list_1[i]+par[6]*r3_x_list_1[i]+
				par[7]*r3_y_list_1[i]+par[8]*r3_z_list_1[i])+(1/rot)*(par[9]*r1_cy_list_4[i]+
				par[10]*r2_cy_list_4[i]+par[11]*r3_cy_list_4[i]))+current_position-desired_positions[i];
		} else if (sector==5) {
			value = ((1/shift)*(par[0]*r1_x_list_1[i]+par[1]*r1_y_list_1[i]+par[2]*r1_z_list_1[i]+
				par[3]*r2_x_list_1[i]+par[4]*r2_y_list_1[i]+par[5]*r2_z_list_1[i]+par[6]*r3_x_list_1[i]+
				par[7]*r3_y_list_1[i]+par[8]*r3_z_list_1[i])+(1/rot)*(par[9]*r1_cy_list_5[i]+
				par[10]*r2_cy_list_5[i]+par[11]*r3_cy_list_5[i]))+current_position-desired_positions[i];
		} else if (sector==6) {
			value = ((1/shift)*(par[0]*r1_x_list_1[i]+par[1]*r1_y_list_1[i]+par[2]*r1_z_list_1[i]+
				par[3]*r2_x_list_1[i]+par[4]*r2_y_list_1[i]+par[5]*r2_z_list_1[i]+par[6]*r3_x_list_1[i]+
				par[7]*r3_y_list_1[i]+par[8]*r3_z_list_1[i])+(1/rot)*(par[9]*r1_cy_list_6[i]+
				par[10]*r2_cy_list_6[i]+par[11]*r3_cy_list_6[i]))+current_position-desired_positions[i];
		}
		value = value;
	}
	// cout << (value) << endl;
	return value;
}

void chi2(int &npar, double *gin, double &f, double *par, int iflag) {
	//calculate chisquare
	double chisq = 0;
	// loop over all layers and vertex position (36 layers + 1 vertex) 
	// sector = 1;
	for (int i = 0; i < 37; ++i) {
		// each value weighted equally, so no division by uncertainty, maybe adjust later?
		chisq += pow(calculate_residual(sector, i, par), 2);
		// cout << i << endl;
	}
	f = chisq; 
}

void minimizer_005() {

	for (int cur_sector = 1; cur_sector < 7; ++cur_sector) {
		TMinuit *gMinuit = new TMinuit(12);  //initialize TMinuit with a maximum of 12 params
		gMinuit->SetPrintLevel(0);
		gMinuit->SetFCN(chi2); // chi^2 function to be minimized
		double arglist[10]; arglist[0] = 1;
		int ierflg = 0;
		gMinuit->mnexcm("SET ERR", arglist, 1, ierflg);
		// Set starting values and step sizes for parameters
		// (param int, name, start value, step size, min limit, upper limit, error flag)
		gMinuit->mnparm(0, "r1x", 0, 0.1, 0, 0, ierflg);
		gMinuit->mnparm(1, "r1y", 0, 0.1, 0, 0, ierflg);
		gMinuit->mnparm(2, "r1z", 0, 0.1, 0, 0, ierflg);
		gMinuit->mnparm(3, "r2x", 0, 0.1, 0, 0, ierflg);
		gMinuit->mnparm(4, "r2y", 0, 0.1, 0, 0, ierflg);
		gMinuit->mnparm(5, "r2z", 0, 0.1, 0, 0, ierflg);
		gMinuit->mnparm(6, "r3x", 0, 0.1, 0, 0, ierflg);
		gMinuit->mnparm(7, "r3y", 0, 0.1, 0, 0, ierflg);
		gMinuit->mnparm(8, "r3z", 0, 0.1, 0, 0, ierflg);
		gMinuit->mnparm(9, "r1cy", 0, 0, 0, 0, ierflg);
		gMinuit->mnparm(10, "r2cy", 0, 0, 0, 0, ierflg);
		gMinuit->mnparm(11, "r3cy", 0, 0, 0, 0, ierflg);

		arglist[1] = 1.0; arglist[0] = 50000;
		gMinuit->mnexcm("MIGRAD", arglist, 2, ierflg);

		// sector++;

	}
}